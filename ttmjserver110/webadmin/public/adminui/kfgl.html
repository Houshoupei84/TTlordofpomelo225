<html>
<head>
    <meta http-equiv=Content-Type content="text/html; charset=UTF-8">
    <link rel="stylesheet" type="text/css" href="/easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="/easyui/themes/icon.css">
    <script type="text/javascript" src="/easyui/jquery.min.js"></script>
    <script type="text/javascript" src="/easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="/share.js"></script>
</head>
<body  class="easyui-layout">
    <div style="margin:2px 0;">
        <a href="#" class="easyui-linkbutton" onclick="LoadData(3)">近3天</a>
        <a href="#" class="easyui-linkbutton" onclick="LoadData(7)">近7天</a>
        <a href="#" class="easyui-linkbutton" onclick="LoadData(30)">近30天</a>
        <a href="#" class="easyui-linkbutton" onclick="LoadData(90)">近90天</a>
        <a href="#" class="easyui-linkbutton" onclick="LoadData(365)">近一年</a>
<!--         <span style="font-size:16px line-height:20px">查询记录:</span>
        <select class="easyui-combobox" id="requestrecord" name="查询记录" style="width:10%;">
            <option value="3">近3天</option>
            <option value="7">近7天</option>
            <option value="30">近30天</option>
            <option value="90">近90天</option>
            <option value="365">近1年</option>
        </select> -->
    </div>
    <table  id="dg" class="easyui-datagrid" title="Basic DataGrid" style="width:100%;height:95%"
            data-options="singleSelect:true,collapsible:true">
        <thead>
        <tr>
            <th data-options="field:'cmanager'">客户经理</th>
            <th data-options="field:'date'">日期</th>
            <th data-options="field:'money'">充值金额-钻</th>
            <th data-options="field:'client'">开发客户数量</th>
        </tr>
        </thead>
    </table>
    <script type="text/javascript">
        function LoadDate(startDate,endDate) {
//            postJson("/admin/data",{startDate: startDate.getTime(),endDate: endDate.getTime()},
//                    function(data)
//                    {
//                        $("#dg").datagrid("loadData",data);
//                    }
//            );

            var day = endDate.getTime() - startDate.getTime();

            var days = Math.floor(day / (24 * 3600 * 1000));//相差天数

//            var leave1 = day % (24*3600*1000);    //计算天数后剩余的毫秒数
//            var hours = Math.floor(leave1/(3600*1000));//相差小时
//
//            var leave2 = leave1 % (3600*1000);        //计算小时数后剩余的毫秒数
//            var minutes = Math.floor(leave2/(60*1000));//相差分钟
//
//            var leave3 = leave2 % (60*1000);    //计算分钟数后剩余的毫秒数
//            var seconds = Math.round(leave3/1000);//相差毫秒

            //var oldTime = (new Date("2014/03/31 12:10:10")).getTime(); //得到毫秒数
            //var newTime = new Date(oldTime); //就得到普通的时间了

            var data_ = {rows: []};

            var time = new Date();
            var time_ = time.getFullYear() + '-' + (time.getMonth() + 1) + '-' + time.getDate();

            var totalmoney = 0, totalclient = 0;

            for (var i = 0; i < days + 1; i++) {
                var name = '经理' + ((new Date()).getSeconds() + 1);

                data_.rows[data_.rows.length] = {
                    "cmanager": name,
                    "date": time_,
                    "money": 10 + i,
                    "client": 50 + i
                };
            }

            for (var i = 0; i < data_.rows.length; i++) {
                totalmoney += data_.rows[i].money;
                totalclient += data_.rows[i].client;
            }

            data_.rows[data_.rows.length] = {
                "cmanager": "合计",
                "date": time_,
                "money": totalmoney,
                "client": totalclient
            };

            $("#dg").datagrid("loadData", data_);
            if(data_.total==0){
                $('#dg').datagrid('appendRow',{cmanager:"没有数据", date:"", money:"", client:""});
            }
        }
        function LoadData(dayNum)
        {
            var endDate=new Date();
            var startDate=new Date();
            startDate.setDate(startDate.getDate()-(dayNum-1));
            LoadDate(startDate,endDate);
        }
        $(document).ready(function(){
            $("#requestrecord").combobox({
            
                onChange: function () {
                    
                    var dayValue=$("#requestrecord").combobox('getValue');

                    LoadData(dayValue);
                }

          });

        })
        

    </script>
</body>
</html>