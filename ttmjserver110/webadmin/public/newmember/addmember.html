<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-cmn-Hans">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
    <title>添加会员</title>
    <link rel="stylesheet" href="../newcss/reset.css">
    <link href="../bootstrap/css/bootstrap.min.css" title="" rel="stylesheet" />
    <link title="" href="../newcss/style.css" rel="stylesheet" type="text/css"  />
    <link title="blue" href="../newcss/dermadefault.css" rel="stylesheet" type="text/css"/>
    <link href="../newcss/templatecss.css" rel="stylesheet" title="" type="text/css" />
    <link rel="stylesheet" href="../newcss/jqpagination.css">
</head>
<style>
    @media only screen and (min-width:320px) and (max-width:480px){
        .alert{
            display: none;
            position: absolute;
            top: 80%;
            left: 50%;
            -ms-transform: translate(-50%, -80%);
            -moz-transform: translate(-50%, -80%);
            -o-transform: translate(-50%, -80%);
            transform: translate(-50%, -80%);
            z-index: 2000;
        }
    }
    @media (min-width:481px) {
        .alert{
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            -ms-transform: translate(-50%, -50%);
            -moz-transform: translate(-50%, -50%);
            -o-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
            z-index: 2000;
        }
    }
</style>
<body>
<div class="alert alert-info alert-dismissable" role="alert">
    <button class="close" type="button" onclick="$('.alert').eq(0).hide();">&times;</button>
    <span></span>
</div>
<nav class="nav navbar-default navbar-mystyle navbar-fixed-top">
    <div class="navbar-header">
        <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand mystyle-brand"><span class="glyphicon glyphicon-plus"></span></a></div>
    <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav pull-right">
            <li class="dropdown li-border"><a href="#" class="dropdown-toggle mystyle-color" data-toggle="dropdown"><span id="userNick">3179923507@qq.com</span><span class="caret"></span></a>
                <ul class="dropdown-menu">
                    <li><a href="#" id="logout">退出</a></li>
                </ul>
            </li>
        </ul>
    </div>
</nav>
<div class="down-main">
    <div class="left-main left-off">
        <div class="sidebar-fold"><span class="glyphicon glyphicon-menu-hamburger"></span></div>
        <div class="subNavBox">
            <div class="sBox">
                <ul class="navContent" style="display:block">
                    <li>
                        <div class="showtitle" style="width:100px;"><img src="../img/leftimg.png" />首页</div>
                        <a href="index.html"><span class="sublist-icon glyphicon glyphicon-home"></span><span class="sub-title">首页</span></a></li>
                    <li>
                        <div class="showtitle" style="width:100px;"><img src="../img/leftimg.png" />出售</div>
                        <a href="sale.html"><span class="sublist-icon glyphicon glyphicon-tag"></span><span class="sub-title">出售</span></a></li>
                    <li>
                        <div class="showtitle" style="width:100px;"><img src="../img/leftimg.png" />充值</div>
                        <a href="charge.html"><span class="sublist-icon glyphicon glyphicon-shopping-cart"></span><span class="sub-title">充值</span></a></li>
                    <li>
                        <div class="showtitle" style="width:100px;"><img src="../img/leftimg.png" />充值记录</div>
                        <a href="rechargerecord.html"><span class="sublist-icon glyphicon glyphicon-time"></span><span class="sub-title">充值记录</span></a></li>
                    <li>
                        <div class="showtitle" style="width:100px;"><img src="../img/leftimg.png" />出售记录</div>
                        <a href="salerecord.html"><span class="sublist-icon glyphicon glyphicon-star-empty"></span><span class="sub-title">出售记录</span></a></li>
                    <li class="active" id="addMember">
                        <div class="showtitle" style="width:100px;"><img src="../img/leftimg.png" />添加会员</div>
                        <a href="addmember.html"><span class="sublist-icon glyphicon glyphicon-plus"></span><span class="sub-title">添加会员</span></a></li>
                    <li>
                        <div class="showtitle" style="width:100px;"><img src="../img/leftimg.png" />我的会员</div>
                        <a href="recommand.html"><span class="sublist-icon glyphicon glyphicon-user"></span><span class="sub-title">我的会员</span></a></li>
                    <li>
                        <div class="showtitle" style="width:100px;"><img src="../img/leftimg.png" />会员中心</div>
                        <a href="set.html"><span class="sublist-icon glyphicon glyphicon-cog"></span><span class="sub-title">会员中心</span></a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="right-product right-off">
        <div class="container-fluid">
            <div class="info-center">
                <div class="page-header">
                    <div class="pull-left">
                        <h4>添加会员<small id="gameName"></small></h4>
                    </div>
                </div>
                <div class="clearfix"></div>
                <ul class="addMember form-horizontal" role="form">
                    <li class="form-group">
                        <label for="mNick" class="control-label">微信昵称:</label>
                        <span>
                            <input type="text" class="form-control" id="mNick" placeholder="请填写真实有效的微信昵称">
                        </span>
                    </li>
                    <li class="form-group">
                        <label for="newName" class="control-label">姓名:</label>
                        <span>
                            <input type="text" class="form-control" id="newName" placeholder="请填写被添加人姓名">
                        </span>
                    </li>
                    <li class="form-group">
                        <label for="mAddress" class="control-label">地址:</label>
                        <span>
                            <input type="text" class="form-control" id="mAddress" placeholder="必须是××省/市××市/区">
                        </span>
                    </li>
                    <li class="form-group">
                        <label for="mPhone1" class="control-label">联系电话:</label>
                        <span>
                            <input type="text" class="form-control" id="mPhone1" placeholder="请填写正确的手机号">
                        </span>
                    </li>
                    <li class="form-group">
                        <label for="mPhone2" class="control-label">紧急联系人:</label>
                        <span>
                            <input type="text" class="form-control" id="mPhone2" placeholder="请填写联系人手机号">
                        </span>
                    </li>
                    <li class="form-group">
                        <label for="mAddBy" class="control-label"> 推荐人:</label>
                        <span>
                            <input type="text" class="form-control" id="mAddBy" placeholder="填写推荐人真实姓名">
                        </span>
                    </li>
                    <li class="form-group">
                        <label for="mManager" class="control-label">客户经理:</label>
                        <span>
                            <input type="text" class="form-control" id="mManager" placeholder="填写客户经理真实姓名">
                        </span>
                    </li>
                    <li>
                        <button type="button" class="btn btn-primary" id="submit">确定添加</button>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
</body>
<script src="../script/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="../bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../script/jquery.jqpagination.min.js"></script>
<script src="../script/slidemenu.js"></script>
<script src="../share.js"></script>
<script type="text/javascript">
    $(function(){
        //判断是否是二级用户，进行菜单项的显示隐藏
        function menuShow()
        {
            postJson("/admin/getMyInfo",{msg:"content"},function(rtn) {
                $("#userNick").html(rtn.mName);
                if (rtn) {
                    if (rtn.adminLevel == 2 || rtn.adminLevel == '2') {
                        $("#addMember").css("display", "block");
                    }
                };
            })
        }
        menuShow();
        $("#submit").click(function(e){
            e.preventDefault();
            var msg={
                mNick:$('#mNick').val(),
                mName:$('#newName').val(),
                mAddress:$('#mAddress').val(),
                mPhone1:parseFloat( $('#mPhone1').val() ),
                mPhone2:parseFloat( $('#mPhone2').val() ),
                mAddBy:$('#mAddBy').val(),
                mManager:$('#mManager').val()
            };

            if(msg.mNick.length==0) { $(".alert").eq(0).alertModal('无效昵称',2000); return;}
            if(msg.mName.length==0) { $(".alert").eq(0).alertModal('无效名字',2000); return; }
            if(msg.mAddress.length == 0) {$(".alert").eq(0).alertModal('无效的地址',2000);return;}
            if(!(msg.mPhone1>1000000000)) {$(".alert").eq(0).alertModal('无效联系电话',2000);return;}
            if(!(msg.mPhone2>1000000000)) {$(".alert").eq(0).alertModal('无效紧急联系电话',2000);return;}

            var index = msg.mAddress.indexOf("省");

            if(index < 0) {
                if(msg.mAddress.indexOf("北京市") >= 0 ||
                        msg.mAddress.indexOf("上海市") >= 0 ||
                        msg.mAddress.indexOf("天津市") >= 0 ||
                        msg.mAddress.indexOf("重庆市") >= 0) {
                    if(msg.mAddress.indexOf("区") < 0) {
                        $(".alert").eq(0).alertModal('直辖市请注明所在区',2000);
                        return;
                    }
                } else {
                    $(".alert").eq(0).alertModal('地址必须注明所在省市',2000);
                    return;
                }
            } else {
                index = msg.mAddress.indexOf("市", index);

                if(index < 0) {
                    $(".alert").eq(0).alertModal('地址必须注明所在省市',2000);
                    return;
                }
            }

            msg.mPass=(msg.mPhone1+"");
            msg.mPass=msg.mPass.substr(msg.mPass.length-6);

            postJson("/admin/addMember",msg,
                    function(data)
                    {
                        if(data.n > 0) {
                            $(".alert").eq(0).alertModal('添加成功',2000);
                        }
                        else{
                            $(".alert").eq(0).alertModal('添加失败',2000);
                        }
                    }
            );

            $('#mNick').val("");
            $('#newName').val("");
            $('#mAddress').val("");
            $('#mPhone1').val("");
            $('#mPhone2').val("");
            $('#mAddBy').val("");
            $('#mManager').val("");
        });
        $("#gameName").html(getGameType(window.location.host).agentname);
        $("#logout").click(function(e){
            e.preventDefault();
            logout();
        })
    })
</script>
</html>
