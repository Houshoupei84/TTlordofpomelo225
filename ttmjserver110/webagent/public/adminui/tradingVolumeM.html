<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv=Content-Type content="text/html; charset=UTF-8">
    <link rel="stylesheet" type="text/css" href="/easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="/easyui/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="/ui/materialRippleEffect/icon.css">
    <link rel="stylesheet" type="text/css" href="/ui/zeroModal/css/zeroModal.css">

    <script type="text/javascript" src="/easyui/jquery.min.js"></script>
    <script type="text/javascript" src="/easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="/share.js"></script>
    <title>财务报表（月）</title>
</head>
<body>
    <div data-options="region:'north',title:'North Title',split:true" style="height:100%;">
        <div>
            <select class="easyui-combobox" id="type1" name="type1" style="width:120px;">
                <option value="0">汇总数据</option>
                <option value="1">产品对比</option>
            </select>
            <select class="easyui-combobox" id="type2" name="type2" style="width:120px;">
            </select>
            <input class="easyui-datebox" id="planYear" name="planYear" data-options="required:true,formatter:yearFormatter,parser:yearParser"  style="width:140px">
            <a href="#" class="easyui-linkbutton" onclick="searchForRecords()">查询</a>
            <a href="#" class="easyui-linkbutton" onclick="downExcel()">下载Excel</a>
        </div>
        <table id="dg" class="easyui-datagrid" title="财务报表(月)" style="width:100%;height:95%"
               data-options="singleSelect:true,collapsible:true">
        </table>
    </div>
<script>
        function yearFormatter(date){
            var y = date.getFullYear();
            var m = date.getMonth()+1;
            var d = date.getDate();
            return y;
        };

        function yearParser(s){
            if (!s) return new Date();
            var y = s;
            var date;
            if (!isNaN(y)){
                return new Date(y,0,1);
            } else {
                return new Date();
            }
        };
    $(function(){
        var proname="";
        $('#type2').combobox({
            method:'get',
            url:'select1.json',
            valueField:'id',
            textField:'text',
            onSelect: function(){
                proname = $("#type2").combobox('getValue');
            }
        });
        $('#dg').datagrid({columns:[[
            {field:'memsale',title:'会员-钻石销售数量-钻',width:125},
            {field:'memsaleMoney',title:'会员-钻石销售金额-元',width:125}]]});
        $('#type1').combobox({
            onSelect: function(){
                var type = $("#type1").combobox('getValue');
                var cols=[];
                if(type=="0"){
                    var columns1=[
                        {field:'memsale',title:'会员-钻石销售数量-钻',width:125},
                        {field:'memsaleMoney',title:'会员-钻石销售金额-元',width:125}
                    ];
                }else{
                    var columns1=[
                        {field:'memsale',title:'用户-钻石销售数量-钻',width:125},
                        {field:'memsaleMoney',title:'用户-钻石销售金额-元',width:125}
                    ];
                }
                cols.push(columns1);
                $('#dg').datagrid({columns:cols});
            }
        });
    });
</script>
</body>
</html>